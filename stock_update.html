<!DOCTYPE html>
<html lang="en">

<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous"
        referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r121/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.birds.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
        }

        label {
            font-size: 1.2rem;
            color: #f5f5f5;
        }
    </style>
    <title>Document</title>
</head>

<body class="bg-dark">
    <div class="display-3 text-light text-center pt-3">‡πÄ‡∏ö‡∏¥‡∏Å-‡∏Ñ‡∏∑‡∏ô ‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà BME</div>
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-md-4 text-center">
                <label for="name">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å</label>C
                <input list="names" type="text" class="form-control" id="name" name="id" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ö‡∏¥‡∏Å">
                <datalist id="names">
                    <option value="‡∏ò‡∏µ‡∏£‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏™‡∏∏‡∏Ç‡∏Å‡∏¥‡∏à">‡∏ò‡∏µ‡∏£‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏™‡∏∏‡∏Ç‡∏Å‡∏¥‡∏à</option>
                    <option value="‡πÄ‡∏™‡∏¥‡∏£‡∏°‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥ ‡πÅ‡∏Æ‡∏î‡∏à‡πà‡∏≤‡∏á">‡πÄ‡∏™‡∏¥‡∏£‡∏°‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥ ‡πÅ‡∏Æ‡∏î‡∏à‡πà‡∏≤‡∏á</option>
                    <option value="‡∏®‡∏£‡∏±‡∏ì‡∏¢‡πå ‡∏ò‡∏£‡∏£‡∏°‡∏Å‡∏£">‡∏®‡∏£‡∏±‡∏ì‡∏¢‡πå ‡∏ò‡∏£‡∏£‡∏°‡∏Å‡∏£</option>
                    <option value="‡∏≠‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏±‡∏ô‡∏ò‡πå ‡πÄ‡∏≠‡∏µ‡πà‡∏¢‡∏°‡∏î‡∏µ">‡∏≠‡∏¥‡∏ó‡∏ò‡∏¥‡∏û‡∏±‡∏ô‡∏ò‡πå ‡πÄ‡∏≠‡∏µ‡πà‡∏¢‡∏°‡∏î‡∏µ</option>
                    <option value="‡∏™‡∏£‡∏≤‡∏ß‡∏∏‡∏ò ‡∏´‡∏°‡∏±‡πà‡∏ô‡∏ä‡∏µ‡∏ó‡∏ß‡∏ô">‡∏™‡∏£‡∏≤‡∏ß‡∏∏‡∏ò ‡∏´‡∏°‡∏±‡πà‡∏ô‡∏ä‡∏µ‡∏ó‡∏ß‡∏ô</option>
                    <option value="‡∏ô‡∏§‡∏ä‡∏≤ ‡πÑ‡∏ä‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå">‡∏ô‡∏§‡∏ä‡∏≤ ‡πÑ‡∏ä‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå</option>
                    <option value="‡∏®‡∏®‡∏¥‡∏°‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏Ç‡∏±‡∏ô‡∏ò‡∏∞‡πÇ‡∏Æ‡∏°">‡∏®‡∏®‡∏¥‡∏°‡∏≤‡∏†‡∏£‡∏ì‡πå ‡∏Ç‡∏±‡∏ô‡∏ò‡∏∞‡πÇ‡∏Æ‡∏°</option>
                    <option value="‡∏õ‡∏ì‡∏≤‡∏•‡∏µ ‡πÄ‡∏≠‡∏∑‡πâ‡∏≠‡∏™‡∏∏‡∏£‡∏ó‡∏£‡∏ô‡∏û">‡∏õ‡∏ì‡∏≤‡∏•‡∏µ ‡πÄ‡∏≠‡∏∑‡πâ‡∏≠‡∏™‡∏∏‡∏£‡∏ó‡∏£‡∏ô‡∏û</option>
                    <option value="‡∏ä‡∏≤‡∏ç‡∏ä‡∏±‡∏¢ ‡πÅ‡∏ã‡πà‡∏•‡∏µ‡πà">‡∏ä‡∏≤‡∏ç‡∏ä‡∏±‡∏¢ ‡πÅ‡∏ã‡πà‡∏•‡∏µ‡πà</option>
                    <option value="‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏ì‡∏µ ‡∏°‡∏á‡∏Ñ‡∏•‡∏ò‡∏ô‡∏≤‡∏ô‡∏ô‡∏ó‡πå">‡∏â‡∏±‡∏ï‡∏£‡∏°‡∏ì‡∏µ ‡∏°‡∏á‡∏Ñ‡∏•‡∏ò‡∏ô‡∏≤‡∏ô‡∏ô‡∏ó‡πå</option>
                    <option value="‡∏≠‡∏ô‡∏∏‡∏†‡∏≤‡∏û ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡πÇ‡∏ï">‡∏≠‡∏ô‡∏∏‡∏†‡∏≤‡∏û ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡πÇ‡∏ï</option>
                    <option value="‡∏î‡∏£‡∏±‡∏ì‡∏†‡∏û ‡∏¢‡∏¥‡πâ‡∏°‡πÅ‡∏¢‡πâ‡∏°">‡∏î‡∏£‡∏±‡∏ì‡∏†‡∏û ‡∏¢‡∏¥‡πâ‡∏°‡πÅ‡∏¢‡πâ‡∏°</option>
                </datalist>
            </div>
        </div>
        <div class="row mt-3 justify-content-center">
            <div class="col-md-4 text-center">
                <label for="dept">‡πÅ‡∏ú‡∏ô‡∏Å/Work Order</label>
                <input type="text" class="form-control" id="dept" name="dept" placeholder="‡πÅ‡∏ú‡∏ô‡∏Å ‡∏´‡∏£‡∏∑‡∏≠ Work Order">
            </div>
        </div>
        <div class="row mt-3 justify-content-center">
            <div class="col-md-4 text-center">
                <label for="type">‡πÄ‡∏ö‡∏¥‡∏Å-‡∏Ñ‡∏∑‡∏ô</label>
                <select type="text" class="form-control" id="type" name="type">
                    <option value="" selected disabled></option>
                    <option value="‡πÄ‡∏ö‡∏¥‡∏Å">‡πÄ‡∏ö‡∏¥‡∏Å‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà</option>
                    <option value="‡∏Ñ‡∏∑‡∏ô">‡∏Ñ‡∏∑‡∏ô‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà</option>
                </select>
            </div>
        </div>
        <div class="row mt-3 justify-content-center">
            <div class="col-md-4 text-center">
                <label for="part">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà</label>
                <select type="text" class="form-control" id="part" name="part">
                    <option value="" selected disabled></option>
                </select>
            </div>
            <div class="col-12 text-center" style="display: none;">
                <p class="text-danger">‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠&nbsp;<span id="remain"></span> unit</p>
            </div>
        </div>
        <div class="row mt-3 justify-content-center">
            <div class="col-md-4 text-center">
                <label for="amount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô unit</label>
                <input type="number" inputmode="numeric" class="form-control" id="amount" name="amount" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô">
            </div>
        </div>
        <div class="row mt-3 justify-content-center">
            <div class="col-md-4 text-center">
                <button id="submit-btn" class="btn btn-warning" style="min-width:300px">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>
    <script>
        // VANTA.BIRDS({
        //     el: "body",
        //     mouseControls: true,
        //     touchControls: true,
        //     gyroControls: false,
        //     minHeight: 200.00,
        //     minWidth: 200.00,
        //     scale: 1.00,
        //     scaleMobile: 1.00
        // })
    </script>
    <script>
        var scripturl = 'https://script.google.com/macros/s/AKfycbye0Yuun9q7Hmf5g-8iHrlJTDK5Uwi8QP-AI6wOXNJvFFuXOYv-dhbmWArgHjrjbjqSmg/exec'
        $(document).ready(function () {
            $.getJSON(scripturl + '?opt=getpart', function (data) {
                console.log("üöÄ ~ data", data)
                data.forEach(element => {
                    $('#part').append('<option value="' + element[0] + '_' + element[2] + '">' + element[1] + '</option>')
                });
            })
        })

        $('#submit-btn').click(function () {
            Swal.fire({
                icon: 'info',
                title: 'Saving...',
                text: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                allowOutsideClick: false,
            })
            Swal.showLoading(Swal.getConfirmButton())
            var name = $('#name').val()
            var dept = $('#dept').val()
            var type = $('#type').val()
            var part = $('#part').val().trim().replace('#', '%23').split('_')[0]
            console.log("üöÄ ~ part", part)
            var amount = $('#amount').val()
            if (name == '' || dept == '' || type == '' || part == '') {
                Swal.fire({
                    icon: 'error',
                    title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
                    showConfirmButton: false,
                    timer: 1500
                })
            } else {
                $.getJSON(scripturl + '?opt=add&name=' + name + '&dept=' + dept + '&type=' + type + '&part=' + encodeURI(part) + '&amount=' + amount, function (data) {
                    console.log("üöÄ ~ data", data)
                    if (data.status == 'success') {
                        return Swal.fire({
                            icon: 'success',
                            title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢',
                            showConfirmButton: false,
                            timer: 2000
                        }).then(function () {
                            location.reload()
                        })

                    } else if (data.status == 'not enough') {
                        return Swal.fire({
                            icon: 'error',
                            title: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏≠‡∏∞‡πÑ‡∏´‡∏•‡πà‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠',
                            showConfirmButton: false,
                            timer: 2000
                        })
                    }
                    else {
                        return Swal.fire({
                            icon: 'error',
                            title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                            showConfirmButton: false,
                            timer: 1500
                        })
                    }
                })
            }
        })

        $('#part').change(function () {
            var part = $('#part').val()
            let remain = part.split('_')[1]
            $('#remain').addClass('text-danger').text(remain)
            $('#remain').closest('.col-12').slideDown()

        })
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</body>

</html>